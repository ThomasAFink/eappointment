#!/usr/bin/env php
<?php
$dir = realpath(__DIR__);
do {
    $dir = dirname($dir);
    if (file_exists("$dir/autoload.php")) {
        require_once("$dir/autoload.php");
    }
} while ($dir != '/' && !file_exists("$dir/config.php"));
if (file_exists("$dir/bootstrap.php")) {
    require("$dir/bootstrap.php");
} else {
    require("$dir/config.php");
}
$usage = <<<EOS

Usage: {$argv[0]} year [--verbose] [--pending] --commit
        ATTENTION! Saves dayoff data until given year from current year
        !!!!!!!!!!!!!!!!!!!!!!!
        !! DATA LOSS WARNING !!
        !!!!!!!!!!!!!!!!!!!!!!!
EOS;

$year = $argv[1];
if ($year) {
    $job = new \BO\Zmsadmin\Helper\CalculateDayOff();
    $job->writeDayOffListUntilYear($year);
} else {
    error_log("Missing year argument!$usage");
}
