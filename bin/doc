#!/bin/bash

REALPATH=$(which realpath || which readlink)
REALPATH=$([[ "$REALPATH" =~ 'readlink' ]] && echo "$REALPATH -e" || echo "$REALPATH")
DIR=$(dirname $($REALPATH ${BASH_SOURCE[0]}))
ROOT=$($REALPATH $DIR/..)

npm run doc
wget -P $ROOT/public/doc/ "https://cdn.redoc.ly/redoc/latest/bundles/redoc.standalone.js"
swagger-cli validate $ROOT/public/doc/swagger.yaml
swagger-cli bundle -r -o $ROOT/public/doc/swagger.json $ROOT/public/doc/swagger.yaml